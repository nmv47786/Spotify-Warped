(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const{VITE_SPOTIFY_CLIENT_ID:T,VITE_TM_CLIENT_ID:w}={VITE_SPOTIFY_CLIENT_ID:"7f471d52e4ff476ca55615472b77340c",VITE_TM_CLIENT_ID:"jZVke8wnys1BLgIF6KMpGGfg0PhukPOs",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};console.log("Spotify Client ID:",T);console.log("Ticketmaster Client ID:",w);const g=T,I=w,E=new URLSearchParams(window.location.search),h=E.get("code");_();async function _(){if(!h)k(g);else{const t=await $(g,h),e=await b(t);B(t,e),console.log(e)}}async function k(t){const e=L(128),n=await S(e);localStorage.setItem("verifier",e);const r=new URLSearchParams;r.append("client_id",t),r.append("response_type","code"),r.append("redirect_uri","http://localhost:5173/callback"),r.append("scope","user-read-private user-read-email user-top-read user-follow-read"),r.append("code_challenge_method","S256"),r.append("code_challenge",n),document.location=`https://accounts.spotify.com/authorize?${r.toString()}`}function L(t){let e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}async function S(t){const e=new TextEncoder().encode(t),n=await window.crypto.subtle.digest("SHA-256",e);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(n)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $(t,e){const n=localStorage.getItem("verifier"),r=new URLSearchParams;r.append("client_id",t),r.append("grant_type","authorization_code"),r.append("code",e),r.append("redirect_uri","http://localhost:5173/callback"),r.append("code_verifier",n);const o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r}),{access_token:s}=await o.json();return s}async function b(t){return await(await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${t}`}})).json()}function C(){return new Promise((t,e)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(n=>{const r=n.coords.latitude,o=n.coords.longitude;t({latitude:r,longitude:o})},n=>{console.error("Error getting user's location:",n),e(n)}):e("Geolocation is not available in this browser.")})}async function B(t,e){try{let n=await C();n||(n={latitude:33.749,longitude:-84.388}),console.log("User's Latitude:",n.latitude),console.log("User's Longitude:",n.longitude),H(e,t,n.latitude,n.longitude)}catch(n){console.error("Error:",n)}}async function f(t,e,n,r){const o={headers:{Authorization:`Bearer ${r}`},method:e};e!=="GET"&&e!=="HEAD"&&(o.body=JSON.stringify(n));try{const s=await fetch(`https://api.spotify.com/${t}`,o);if(!s.ok)throw new Error(`Fetch error: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error("Error fetching data:",s),s}}async function x(t){return(await f("v1/me/top/tracks","GET",void 0,t)).items}async function U(t){return(await f("v1/me/top/tracks","GET",void 0,t)).items.map(n=>n.id)}async function P(t){return(await f("v1/me/top/artists","GET",void 0,t)).items}async function D(t){return(await f("v1/me/top/artists?time_range=short_term","GET",void 0,t)).items}async function M(t){return(await f("v1/me/top/artists","GET",void 0,t)).items.map(n=>n.id)}async function N(t,e){const n=[];for(let o=0;o<e.length;o+=5){const i=`v1/recommendations?limit=5&seed_tracks=${e.slice(o,o+5).join(",")}`;try{const l=await f(i,"GET",void 0,t);n.push(...l.tracks)}catch(l){throw console.error("Error fetching recommendations:",l),l}}return n}async function O(t,e){const n=[];for(let r=0;r<e.length;r++){const i=`v1/artists/${e.slice(r,r+1)[0]}/related-artists`;try{const c=(await f(i,"GET",void 0,t)).artists.map(({name:a})=>a),d=Math.floor(Math.random()*c.length),u=c[d];n.push(u)}catch(l){throw console.error("Error fetching recommendations:",l),l}}return n}function j(t){const e=Array.from(t),n=e.length,r=e.slice(0,3),o=new Set,s=new Set,i=new Set;for(let a=3;a<n;a+=3)a<n&&o.add(e[a]),a+1<n&&s.add(e[a+1]),a+2<n&&i.add(e[a+2]);const l=document.querySelectorAll(".flyerHeadliner"),c=document.getElementById("day1Artists"),d=document.getElementById("day2Artists"),u=document.getElementById("day3Artists");o.forEach(a=>{c.innerHTML+=`<div class="flyerArtist">${a}</div>`}),s.forEach(a=>{d.innerHTML+=`<div class="flyerArtist">${a}</div>`}),i.forEach(a=>{u.innerHTML+=`<div class="flyerArtist">${a}</div>`});for(let a=0;a<r.length;a++)l[a].textContent=r[a]}async function F(t,e,n,r){const o=`https://app.ticketmaster.com/discovery/v2/events.json?keyword=${encodeURIComponent(t)}&size=5&latlong=${e},${n}&radius=${r}&apikey=${I}`;try{const i=await(await fetch(o)).json(),l=i._embedded?i._embedded.events:[],c=[];for(const d of l){const u=d.dates.start.localDate,a=d._embedded.venues[0].city.name,p=d._embedded.venues[0].name,m=d.dates.start.localTime,y=d.url;c.push({eventDate:u,eventCity:a,eventVenue:p,eventTime:m,eventUrl:y})}return c}catch{return[]}}async function G(t,e,n,r){const o=[],s=Array.from(t);for(const i of s){const l=await F(i,e,n,r);if(l&&l.length>0)for(const c of l){const{eventDate:d,eventCity:u,eventVenue:a,eventTime:p,eventUrl:m}=c,y=R(i);o.push(`
                    Event for ${i} on ${d} in ${u}<br>
                    Venue: ${a}<br>
                    Time: ${p}<br>
                    <a href="${m}" target="_blank">Buy Tickets</a><br>
                    <a href="${y}" target="_blank">View Setlist Statistics</a>
                `)}}return o}function R(t){return`https://www.setlist.fm/search?query=${encodeURIComponent(t)}`}async function H(t,e,n,r){if(document.getElementById("displayName").innerText=t.display_name,t.images[0]){const c=new Image(200,200);c.src=t.images[0].url,document.getElementById("avatar").appendChild(c)}document.getElementById("id").innerText=t.id,document.getElementById("email").innerText=t.email,document.getElementById("followers").innerText=t.followers.total,document.getElementById("uri").innerText=t.uri,document.getElementById("uri").setAttribute("href",t.external_urls.spotify);const o=await x(e);if(Array.isArray(o)){const c=o.map(({name:d,artists:u})=>`${d} by ${u.map(a=>a.name).join(", ")}`);document.getElementById("topTracks").innerText=c.join(`
`)}else document.getElementById("topTracks").innerText="No top tracks found.";const s=await P(e);if(Array.isArray(s)){const c=s.map(({name:d})=>d);document.getElementById("topArtists").innerText=c.join(`
`)}else document.getElementById("topArtists").innerText="No top artists found.";const i=await U(e);if(Array.isArray(i)&&i.length>0){const c=await N(e,i);if(Array.isArray(c)){const d=c.map(({name:u,artists:a})=>`${u} by ${a.map(p=>p.name).join(", ")}`);document.getElementById("recommendedTracks").innerText=d.join(`
`)}else document.getElementById("recommendedTracks").innerText="No recommended tracks found."}else document.getElementById("recommendedTracks").innerText="No top tracks found.";const l=await M(e);if(Array.isArray(s)&&s.length>0){const c=await O(e,l),d=await D(e),u=new Set([...s.map(({name:m})=>m),...c,...d.map(({name:m})=>m)]),a=Array.from(u);console.log("Festival List:",Array.from(a)),G(a,n,r,100).then(m=>{const y=document.getElementById("eventInfo");if(m.length>0){const v=m.map(A=>`<p>${A}</p>`).join("");y.innerHTML=`
                    <div class="eventInfoHeader">Upcoming Concerts</div>
                    ${v}
                `}else y.innerHTML=`
                    <div class="eventInfoHeader">No Upcoming Concerts Found</div>
                `}),window.onload=j(a)}}
